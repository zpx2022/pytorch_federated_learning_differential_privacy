[English](README.md) | [ç®€ä½“ä¸­æ–‡](README.zh-CN.md)
# è”é‚¦å­¦ä¹ å’ŒåŸºäºæ‹‰æ™®æ‹‰æ–¯æœºåˆ¶çš„å·®åˆ†éšç§æŠ€æœ¯çš„ç»“åˆ

**é¡¹ç›®è¯´æ˜ï¼š** æœ¬é¡¹ç›®æ˜¯ [rruisong/pytorch_federated_learning](https://github.com/rruisong/pytorch_federated_learning) çš„ä¸€ä¸ªåˆ†æ”¯ï¼Œæœ¬äººå¯¹åŸä½œè€…çš„åŸºç¡€æ€§å·¥ä½œè¡¨ç¤ºæ„Ÿè°¢ã€‚

## âœ¨ æ ¸å¿ƒç‰¹æ€§

ç›¸è¾ƒäºçˆ¶é¡¹ç›®ï¼Œæœ¬é¡¹ç›®å®ç°äº†åŸºäºæ‹‰æ™®æ‹‰æ–¯æœºåˆ¶çš„éšç§ä¿æŠ¤ï¼Œåšå‡ºäº†ä¸€ç³»åˆ—çš„æ¶æ„ä¼˜åŒ–ï¼š
- **æ”¯æŒæœ¬åœ°å·®åˆ†éšç§ (LDP)**: é›†æˆäº† LDP æœºåˆ¶ï¼Œå¯é€šè¿‡é…ç½®å¼€å¯æ¢¯åº¦è£å‰ª (Gradient Clipping) å’Œæ‹‰æ™®æ‹‰æ–¯å™ªå£° (Laplacian Noise) æ·»åŠ ï¼Œç”¨äºç ”ç©¶éšç§ä¿æŠ¤ä¸‹çš„è”é‚¦å­¦ä¹ ã€‚

- **é«˜æ•ˆçš„å¹¶è¡Œæ¨¡æ‹Ÿ**: åˆ©ç”¨ `concurrent.futures` å®ç°äº†å®¢æˆ·ç«¯çš„**å¹¶è¡Œè®­ç»ƒ**ï¼Œå¯å……åˆ†åˆ©ç”¨å¤šæ ¸ CPU èµ„æºï¼Œæ˜¾è‘—ç¼©çŸ­æ¨¡æ‹Ÿæ‰€éœ€æ—¶é—´ã€‚

- **æå‰ç»ˆæ­¢**: æ”¯æŒæå‰ç»ˆæ­¢ (Early Stopping) æœºåˆ¶ï¼Œå½“æ¨¡å‹æ€§èƒ½åœ¨è®¾å®šçš„è€å¿ƒå€¼å†…ä¸å†æå‡æ—¶è‡ªåŠ¨åœæ­¢è®­ç»ƒï¼ŒèŠ‚çº¦è®¡ç®—èµ„æºã€‚

- **æ–­ç‚¹ç»­ä¼ **: èƒ½å¤Ÿè‡ªåŠ¨ä¿å­˜å’ŒåŠ è½½è®­ç»ƒæ£€æŸ¥ç‚¹ (`checkpoint`)ï¼Œæ–¹ä¾¿ä»ä¸­æ–­å¤„æ¢å¤é•¿æ—¶é—´çš„å®éªŒã€‚
  
- **ä¼˜é›…çš„æ¶æ„è®¾è®¡**: é‡‡ç”¨â€œæ¨¡æ¿æ–¹æ³•â€è®¾è®¡æ¨¡å¼é‡æ„äº†å®¢æˆ·ç«¯æ¶æ„ï¼Œæ¶ˆé™¤äº†åœ¨æ¯ä¸ªç®—æ³•ä¸­é‡å¤ç¼–å†™è®­ç»ƒå¾ªç¯çš„å†—ä½™é—®é¢˜ï¼Œæ˜¾è‘—æå‡äº†ä»£ç çš„å¯ç»´æŠ¤æ€§ä¸æ‰©å±•æ€§ã€‚

## âš™ï¸ é¡¹ç›®ç»“æ„

```text
â”œâ”€â”€ config/                    # å­˜æ”¾é…ç½®æ–‡ä»¶
â”‚   â””â”€â”€ test_config.yaml       # ä¸»è¦å®éªŒé…ç½®æ–‡ä»¶
â”œâ”€â”€ fed_baselines/             # æ ¸å¿ƒç®—æ³•å®ç°
â”‚   â”œâ”€â”€ client_base.py         # å®¢æˆ·ç«¯åŸºç±» (å®ç° FedAvg)
â”‚   â”œâ”€â”€ client_fedprox.py      # FedProx ç®—æ³•å®¢æˆ·ç«¯
â”‚   â”œâ”€â”€ client_scaffold.py     # SCAFFOLD ç®—æ³•å®¢æˆ·ç«¯
â”‚   â”œâ”€â”€ client_fednova.py      # FedNova ç®—æ³•å®¢æˆ·ç«¯
â”‚   â”œâ”€â”€ server_base.py         # æœåŠ¡å™¨åŸºç±» (å®ç° FedAvg)
â”‚   â”œâ”€â”€ server_scaffold.py     # SCAFFOLD ç®—æ³•æœåŠ¡å™¨
â”‚   â””â”€â”€ server_fednova.py      # FedNova ç®—æ³•æœåŠ¡å™¨
â”œâ”€â”€ figures/                   # å­˜æ”¾ç”Ÿæˆçš„å›¾è¡¨
â”œâ”€â”€ postprocessing/            # ç»“æœåå¤„ç†
â”‚   â”œâ”€â”€ eval_main.py           # ç»“æœè¯„ä¼°ä¸å¯è§†åŒ–ä¸»ç¨‹åº
â”‚   â””â”€â”€ recorder.py            # ç»“æœè®°å½•ä¸ç»˜å›¾å·¥å…·ç±»
â”œâ”€â”€ preprocessing/             # æ•°æ®é¢„å¤„ç†
â”‚   â””â”€â”€ baselines_dataloader.py# æ•°æ®åŠ è½½ä¸ Non-IID åˆ’åˆ†
â”œâ”€â”€ utils/                     # è¾…åŠ©å·¥å…·
â”‚   â”œâ”€â”€ models.py              # ç¥ç»ç½‘ç»œæ¨¡å‹å®šä¹‰
â”‚   â””â”€â”€ fed_utils.py           # è”é‚¦å­¦ä¹ è¾…åŠ©å‡½æ•°
â”œâ”€â”€ fl_main.py                 # è”é‚¦å­¦ä¹ ä¸»è®­ç»ƒç¨‹åº
â””â”€â”€ requirements.txt           # Python ä¾èµ–åŒ…åˆ—è¡¨
```

## ğŸš€ å¿«é€Ÿå¼€å§‹

### 1. ç¯å¢ƒå‡†å¤‡

å»ºè®®ä½¿ç”¨è™šæ‹Ÿç¯å¢ƒï¼ˆå¦‚ `conda` æˆ– `venv`ï¼‰æ¥ç®¡ç†é¡¹ç›®ä¾èµ–ã€‚

```bash
# å…‹éš†ä»“åº“
git clone https://github.com/zpx2022/pytorch_federated_learning_differential_privacy.git
cd pytorch_federated_learning_differential_privacy

# (å¯é€‰ï¼Œæ¨è) åˆ›å»ºå¹¶æ¿€æ´» conda è™šæ‹Ÿç¯å¢ƒ
conda create -n fldp python=3.8
conda activate fldp

# å®‰è£…ä¾èµ–
pip install -r requirements.txt
```

### 2.é…ç½®å®éªŒ
æ‰“å¼€ test_config.yaml æ–‡ä»¶ï¼Œæ ¹æ®æ‚¨çš„éœ€æ±‚ä¿®æ”¹å®éªŒå‚æ•°ã€‚

### 3.è¿è¡Œè®­ç»ƒ
æ‰§è¡Œä¸»ç¨‹åº fl_main.py å¼€å§‹è®­ç»ƒã€‚æ‰€æœ‰ç»“æœå’Œæ£€æŸ¥ç‚¹å°†é»˜è®¤ä¿å­˜åœ¨ results/ å’Œ checkpoints/ ç›®å½•ä¸‹ã€‚
```bash
python fl_main.py --config test_config.yaml
```

### 4.è¯„ä¼°ä¸å¯è§†åŒ–ç»“æœ
è®­ç»ƒç»“æŸåï¼Œä½¿ç”¨ eval_main.py æ¥ç»˜åˆ¶æ€§èƒ½æ›²çº¿å›¾ã€‚
```bash
# å°† results/ ç›®å½•ä¸‹çš„æ‰€æœ‰ .json ç»“æœæ–‡ä»¶ç»˜åˆ¶æˆå›¾
python eval_main.py --sys-res_root results
```
## ğŸš€ è¿è¡Œæ ·ä¾‹
![ä¸åŒå™ªå£°å¼ºåº¦å‡†ç¡®åº¦&æŸå¤±å˜åŒ–å¯¹æ¯”å›¾](figures/FedAvg_LeNet_MNist_NIID_LDP_Comparison_Annotated.png)
